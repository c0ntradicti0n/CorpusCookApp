
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<style>

span.subject1     {color: red;}
span.contrast1     {color: blue;}

span.subject2      {
    margin: 0.05em;
    padding:0.05em;
    line-height:1.2;
    display:inline-block;
    border-radius:.55em;
    border:2px solid
}
span.contrast2     {
    margin: 0.05em;
    padding:0.05em;
    line-height:1.2;
    display:inline-block;
    border-radius:.025em;
    border:2px solid
}


.indentation     {display:inline-block; 
                  width: 50px;
}
</style>
</head>
<body>
 Generalized   additive   models   for   cancer   mapping   with   incomplete   covariates   Jonathan   L   Frenchgroton.pfizer.com   Harvard   School   of   Public   Health   ,   <br> </br>
   Boston   ,   USA   SUMMARY   Maps   depicting   cancer   incidence   rates   have   become   useful   tools   in   public   health   research   ,   giving   valuable   information   about   the   <br> </br>
   spatial   variation   in   rates   of   disease   .   Typically   ,   these   maps   are   generated   using   count   data   aggregated   over   areas   such   as   counties   or   census   blocks   .   <br> </br>
   However   ,   with   the   proliferation   of   geographic   information   systems   and   related   databases   ,   it   is   becoming   easier   to   obtain   exact   spatial   locations   for   <br> </br>
   the   cancer   cases   and   suitable   control   subjects   .   The   use   of   such   point   data   allows   us   to   adjust   for   individual-level   covariates   ,   such   as   age   and   smoking   <br> </br>
   status   ,   when   estimating   the   spatial   variation   in   disease   risk   .   <br> </br>
   <br> </br>
   Unfortunately   ,   such   covariate   information   is   often   subject   to   missingness   .   We   propose   a   method   for   mapping   cancer   risk   when   covariates   are   not   <br> </br>
   completely   observed   .   We   model   these   data   using   a   logistic   generalized   additive   model   .   Estimates   of   the   linear   and   non-linear   effects   are   obtained   using   <br> </br>
   a   mixed   effects   model   representation   .   We   develop   an   EM   algorithm   to   account   for   missing   data   and   the   random   effects   .   Since   the   expectation   step   involves   <br> </br>
   an   intractable   integral   ,   we   estimate   the   E-step   with   a   Laplace   approximation   .   This   framework   provides   a   general   method   for   handling   missing   covariate   <br> </br>
   values   when   fitting   generalized   additive   models   .   <br> </br>
   <br> </br>
   We   illustrate   our   method   through   an   analysis   of   cancer   incidence   data   from   Cape   Cod   ,   Massachusetts   .   These   analyses   demonstrate   that   standard   <br> </br>
   complete-case   methods   can   yield   biased   estimates   of   the   spatial   variation   of   cancer   risk   .   Keywords   :   Binary   response   Expectation   Maximization   <br> </br>
   Generalized   linear   model   Laplace   approximation   Logistic   regression   Method   of   weights   Missing   data   .   Geographical   information   systems   are   becoming   <br> </br>
   widely   used   in   environmental   health   and   epidemiology   .   Correspondingly   ,   investigators   would   like   to   produce   summary   maps   of   their   data   .   For   example   ,   in   <br> </br>
   the   context   of   environmental   epidemiology   ,   we   might   be   interested   in   a   map   of   relative   cancer   incidence   rates   or   cancer   risk   .   <br> </br>
   <br> </br>
   Many   studies   ,   however   ,   are   unable   to   collect   complete   covariate   information   for   each   subject   .   These   values   may   be   either   missing  <span class="subject level1 subject1"> by   design </span> <span class="contrast level1 contrast1"> (   e.g.   when </span>  <br> </br>
  <span class="contrast level1 contrast1"> some   data   are   collected   on </span>  only   a   subset   of   subjects   )   or   missing   unintentionally   .   <br> </br>
   <br> </br>
   In   this   paper   we   propose   a   method   to   estimate   maps   of   covariate   adjusted   relative   cancer   risk   in   the   presence   of   incomplete   covariate   data   .   To   whom   <br> </br>
   correspondence   should   be   addressed   .   Biostatistics   Vol   .   5   No.   2   c   Oxford   University   Press   2004   all   rights   reserved   .   This   work   was   motivated   by   a   study   of   <br> </br>
   cancer   incidence   on   Cape   Cod   ,   Massachusetts   ,   USA   .   <br> </br>
   <br> </br>
   For   nearly   twenty   years   the   Massachusetts   Department   of  <span class="contrast level1 contrast1"><span class="subject level1 subject1"> Public </span> <span class="subject level1 subject1"> Health </span></span> <span class="contrast level1 contrast1"><span class="contrast level1 contrast1"> ( </span> <span class="contrast level1 contrast1"> MDPH </span> <span class="contrast level1 contrast1"> ) </span></span>  has   maintained   a   cancer   registry   database   which   records   incident   cases   for   <br> </br>
   22   types   of   cancers   ,   including   lung   ,   breast   ,   and   prostate   cancers   .   The   report   summarizing   these   data   for   the   period   198292   showed   elevated   standardized   <br> </br>
   incidence   ratios   for   several   types   of   cancer   in   the   towns   of   Barnstable   ,   Falmouth   ,   Sandwich   ,   Bourne   ,   and   Mashpee  <span class="contrast level1 contrast1"> (   Massachusetts   Department   of   Public </span>  <br> </br>
  <span class="contrast level1 contrast1"> Health   ,   1997   ) </span>  .   <br> </br>
   <br> </br>
   Collectively   ,   these   towns   comprise   a   region   known   as   Upper   Cape   Cod   .   Prostate   cancer   in   men   was   of   particular   concern   since   it   appeared   to   be   the   most   <br> </br>
   elevated   .   The   MDPH   was   interested   in   determining   if   the   elevated   cancer   rates   were   due   to   environmental   factors   ,   including   contaminants   at   several   <br> </br>
   sites   on   the   Massachusetts  <span class="subject level1 subject1"> Military   Reservation </span> <span class="contrast level1 contrast1"> (   MMR   ) </span>  that   have   been   listed   on   the   US   Environmental   Protection   Agency   ’s   National   Priority   List   .   <br> </br>
   <br> </br>
   These   sites   are   of   significant   interest   because   the   MMR   is   situated   above   the   sole-source   aquifer   for   the   Upper   Cape   .   In   addition   to   the   type   of   cancer   ,   the   <br> </br>
   registry   maintains   data   on   the   patient   ’s   residence   and   age   at   the   time   of   diagnosis   ,   as   well   as   gender   and   smoking   status   .   The   data   are   routinely   <br> </br>
   summarized   by   gender   at   the   town   level   ,   but   raw   ,   geo-coded   residence   locations   have   been   collected   for   this   study   .   Assuming   that   adverse   environmental   <br> </br>
   effects   are   likely   to   cause   only   certain   types   of   cancer   ,   this   enables   us   to   overcome   the   problem   of   adjusting   for   population   density   which   is   inherent   in   <br> </br>
   calculating   standardized   incidence   ratios   .   <br> </br>
   <br> </br>
   Such   data   are   available   only   at   the   census   tract   level   which   is   much   coarser   than   the   cancer   data   .   This   type   of   analysis   also   allows   us   to   adjust   for   <br> </br>
   individual   level   covariates   such   as   age   and   smoking   status   .   In   this   paper   we   analyze   data   for   incidence   of   prostate   cancer   on   Upper   Cape   Cod   .   Data   have   been   <br> </br>
   compiled   for   n   3191   men   diagnosed   with   one   of   the   22   types   of   cancer   during   the   period   1987   94   .   While   age   and   location   data   were   collected   for   all   patients   ,   <br> </br>
   smoking   status   was   not   obtained   for   approximately   29   %   of   the   men   .   <br> </br>
   <br> </br>
   The   upper-left   panel   of   Figure   1   displays   the   approximate   locations   of   the   residences   of   the   patients   .   For   confidentiality   reasons   ,   the   points   have   been   <br> </br>
   jittered   .   The   solid   and   empty   dots   correspond   to   prostate   cancer   and   other   cancer   cases   ,   respectively   .   The   lines   correspond   to   the   census   tract   <br> </br>
   boundaries   .   We   see   that   there   are   several   areas   with   a   high   density   of   cancer   cases   these   correspond   to   the   population   centers   on   the   Upper   Cape   and   are   not   <br> </br>
   necessarily   associated   with   any   sort   of   exposures   .   By   using   relative   cancer   mapping   ,   we   assume   that   all   cancer   cases   provide   a   reasonable   surrogate   for   <br> </br>
   population   density   across   the   region   .   <br> </br>
   <br> </br>
   Potential   difficulties   with   relative   cancer   mapping   are   discussed   in   Section   4   .   Table   1   displays   summary   statistics   for   age   and   smoking   status   <br> </br>
   classified   by   cancer   type   .   Age   is   a   categorical   variable   with   categories   defined   by   age   decade  <span class="contrast level1 contrast1"> (   i.e.   age   1   for   ages   between   1   and   10   years   ,   age   2   for   1120 </span>  <br> </br>
  <span class="contrast level1 contrast1"> years   ,   etc </span>  .   )   .   Smoking   status   has   two   categories   :  <span class="subject level1 subject1"> ever-smokers </span> <span class="contrast level1 contrast1"> (   smoke   1   ) </span>  and   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level2 contrast2"><span class="subject level1 subject1"> neversmokers </span> <span class="contrast level1 contrast1"> (   smoke   0 </span></span>  <br> </br>
  <span class="contrast level1 contrast1"> ) </span>  <br> </br>
   <span class='indentation'>  </span>  <span class="subject level2 subject2"> .   Of   the   cohort   of   3191   men </span>  <br> </br>
   ,  <span class="contrast level1 contrast1"> 998   (   31.3   %   ) </span>  were   prostate   cancer   patients   .   <br> </br>
   <br> </br>
   We   see   that   prostate   cancer   patients   are   less   likely   to   be   smokers   than   are   patients   with   other   types   of   cancer   .   This   is   partially   explained   by   the   <br> </br>
   relatively   large   number   of   lung   cancer   patients   ,   most   of   which   were   smokers   .   We   also   see   that   the   pattern   of   missing   data   depends   on   cancer   type   .   Smoking   <br> </br>
   status   is   missing   for   41.0   %   of   the   prostate   cancer   patients   ,   while   24.2   %   of   the   other   cancer   patients   did   not   provide   information   about   smoking   status   .   <br> </br>
   Thus   ,   these   data   are   clearly   not   missing   completely-at-random   in   the   sense   of   Little   and  <span class="contrast level1 contrast1"> Rubin   (   1987   ) </span>  .   <br> </br>
   <br> </br>
   Fitting   maps   of   relative   cancer   risk   ,   and   bivariate   surfaces   in   general   ,   can   be   accomplished   in   a   number   of   ways   .   The   most   commonly   used   methods   are   <br> </br>
  <span class="subject level1 subject1"> kriging </span> <span class="contrast level1 contrast1"> (   e.g.   Cressie   ,   1993   ) </span>  and   thin   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level1 contrast1"><span class="contrast level2 contrast2"> plate   splines   (   Wahba   ,   1990   ) </span></span>  <br> </br>
   .   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level2 contrast2"> The   extension   of   kriging   to   discrete   response   data   is   not   straightforward </span>  <br> </br>
   .   <br> </br>
   <span class='indentation'>  </span>  <span class="subject level2 subject2"> Methods </span> <span class="contrast level2 contrast2"> to   accomplish   this   ,   such   as   indicator   kriging   ,   have   been   developed   ,   but   are   somewhat   ad   hoc </span> <span class="subject level2 subject2"> . </span>  <br> </br>
   <span class='indentation'>  </span>   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level1 contrast1"><span class="contrast level2 contrast2"><span class="subject level2 subject2"> Diggle   et </span>  al.  <span class="contrast level1 contrast1"> ( </span></span></span>  <br> </br>
  <span class="contrast level1 contrast1"><span class="contrast level1 contrast1"> 1998 </span></span>  <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level1 contrast1"><span class="contrast level1 contrast1"><span class="contrast level2 contrast2"> ) </span></span>  have   recently   proposed   an </span> <span class="subject level2 subject2"> attractive   method   for   handling   such   data   using   Markov   chain   Monte   Carlo   methods </span>  <br> </br>
   .   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level2 contrast2"> We   take </span> <span class="subject level2 subject2"> a   different   approach   ,   using   generalized   additive   models   with   a </span> <span class="contrast level2 contrast2"> mixed   model   representation </span>  <br> </br>
   .   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level1 contrast1"><span class="contrast level2 contrast2"> Generalized </span> <span class="subject level1 subject1"> additive </span> <span class="contrast level1 contrast1"> models   (   e.g.   Hastie   and   Tibshirani   ,   1990   ) </span>  provide </span> <span class="subject level2 subject2"> a   flexible   means   of   handling   non-linear   covariate   effects </span>  <br> </br>
   .   <br> </br>
   <span class='indentation'>  </span>  <span class="subject level2 subject2"> These </span> <span class="contrast level2 contrast2"> models   have   gained   widespread   popularity </span>  <br> </br>
   in   <br> </br>
   <span class='indentation'>  </span>  <span class="subject level2 subject2"> a   diverse   set   of   Generalized   additive   models   for </span> <span class="contrast level2 contrast2"> cancer   mapping   with   incomplete   covariates </span>  <br> </br>
   179   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level1 contrast1"><span class="contrast level2 contrast2"> degrees   longitude   de   gr   ee   s </span></span>  <br> </br>
  <span class="contrast level1 contrast1"> la </span>  <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level1 contrast1"><span class="contrast level2 contrast2"> tit   ud </span> <span class="subject level2 subject2"> e   5   41   .6   0   5   41   .7   0   5   41   .8   0   prostate   cancer   other   cancer   Longitude   La   tit   ud   e   5   41   .6   0   5   41   .7   0   5   41   .8   0   Odds   Ratio   (   relative   to   geometric   mean   )   Longitude   La </span></span>  <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level1 contrast1"><span class="subject level2 subject2"> tit   ud   e   5   41   .6   0   5   41   .7   0   5   41   .8   0   Odds   Ratio   (   relative   to   geometric   mean   ) </span>  age   decade   O   dd   s   R   at   io </span>  <br> </br>
   0   .   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level2 contrast2"> 0   0 </span>  <br> </br>
   .   <br> </br>
   <span class='indentation'>  </span>  <span class="subject level2 subject2"> 2   0   . </span> <span class="contrast level2 contrast2"> 4   0 </span> <span class="subject level2 subject2"> .   6   0   . </span> <span class="contrast level2 contrast2"> 8   1 </span> <span class="subject level2 subject2"> .   0   Method   of   Weights   Complete   Case   Fig.   1   .   Upper   Cape   Cod   cancer   data   .   Upper-left   panel   :   Raw   data   .   For   confidentiality   reasons   ,   the   points </span>  <br> </br>
   <span class='indentation'>  </span>  <span class="subject level2 subject2"> have   been   jittered   .   Upper-right   :   Complete-case   estimate   of   the   odds   ratio   as   a   function   of   geography   .   Lower-left   :   Method   of   weights   estimate   of   the </span>  <br> </br>
   <span class='indentation'>  </span>  <span class="subject level2 subject2"> odds   ratio   as   a   function   of   geography   .   Lower-right   :   Estimates   of   the   odds   ratio   for   age   relative   to   the   average   age   in   the   cohort   . </span> <span class="contrast level2 contrast2"> Table   1 </span> <span class="subject level2 subject2"> .   Summary </span>  <br> </br>
   <span class='indentation'>  </span>  <span class="subject level2 subject2"> statistics   for   age   and   smoking   status   ,   classified   by   cancer   type   for   the   Upper   Cape   Cod   data   Prostate   cancer   Other   cancers   nobs   mean </span>  <br> </br>
   sd   nmiss  <span class="contrast level1 contrast1"> (   %   )   nobs   mean   sd </span>  nmiss  <span class="contrast level1 contrast1"> (   %   ) </span>  disciplines   including   environmental   epidemiology   ,   environmental   science   ,   ecology   ,   public   health   ,   political   <br> </br>
   science   ,   and  <span class="subject level1 subject1"> economics </span> <span class="contrast level1 contrast1"> (   e.g.   Linton   and   Hardle   ,   1996   Schwartz   ,   1997   Beck   and   Jackman   ,   1998   Davis   and   Speckman   ,   1999   Engels   et   al.   ,   1999   Roland   et   al.   ,   2000 </span>  <br> </br>
  <span class="contrast level1 contrast1"> ) </span>  .   <br> </br>
   <br> </br>
   Recently   ,   Kammann   and   Wand  <span class="contrast level1 contrast1"> ( </span>  <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level1 contrast1"><span class="contrast level2 contrast2"> 2003   ) </span></span> <span class="subject level2 subject2"> showed   how </span> <span class="contrast level2 contrast2"> kriging   could   be   incorporated   into   a   generalized   additive   model   ,   with   representation   as   a   generalized   linear   mixed   model </span>  <br> </br>
   .   Because   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level2 contrast2"> mixed   models   can   be   fit   using   maximum   likelihood   , </span> <span class="subject level2 subject2"> this   allows </span> <span class="contrast level2 contrast2"> us   to   use   likelihood-based   methods   for   estimation   and   handling   of   missing </span> <span class="subject level2 subject2"> data   .   We   develop </span>  <br> </br>
   <span class='indentation'>  </span>  <span class="subject level2 subject2"> a   method   for   handling   missing   covariate   values   in   generalized   additive   models   using </span> <span class="contrast level2 contrast2"> the   EM </span>  <br> </br>
   algorithm  <span class="contrast level1 contrast1"> (   Dempster   et   al.   ,   1977   ) </span>  .   For   models   other   than   the   Gaussian   response   ,   the   E-step   involves   an   intractable   integral   .   As   in   Steele  <span class="contrast level1 contrast1"> (   1996   ) </span>  we   use   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level1 contrast1"><span class="contrast level2 contrast2"> Laplace   ’s   method   (   Tierney   et   al.   , </span></span>  <br> </br>
  <span class="contrast level1 contrast1"> 1989 </span>  <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level1 contrast1"><span class="subject level2 subject2"> ) </span></span> <span class="contrast level2 contrast2"> to   approximate   this   expectation </span>  <br> </br>
   .   <br> </br>
   <br> </br>
   Section   2   introduces   the   generalized   additive   model   ,   estimation   of   penalized   regression   splines   via   a   mixed   effects   model   ,   and   methods   for   estimation   <br> </br>
   in   generalized   linear   mixed   effects   models   with   complete   data   .   Section   3   develops   an   algorithm   for   estimation   of   generalized   additive   models   in   which   <br> </br>
   some   covariates   exhibit   missingness   .   In   Section   4   ,   we   analyze   the   Cape   Cod   cancer   data   .   We   conclude   with   a   brief   discussion   in   Section   5   .   Additional   <br> </br>
   computational   details   are   provided   in   an   appendix   on   Biostatistics   Online   .   <br> </br>
   <br> </br>
   Suppose   first   that   the   data   are  <span class="contrast level1 contrast1"><span class="contrast level1 contrast1"> ( </span> <span class="contrast level1 contrast1"> xi </span> <span class="contrast level1 contrast1"> , </span> <span class="contrast level1 contrast1"> yi </span> <span class="contrast level1 contrast1"> ) </span></span>  ,   1   i   n   ,   where   the   yi   are   binary   and   xi   R2   represents   geographical   location   .   To   assess   spatial   variation   in   data   of   <br> </br>
   this   type   ,   Diggle   et   al.  <span class="contrast level1 contrast1"> (   1998   ) </span>  propose   the   kriging-type   model   The   right-hand   side   of   (   2.1   )   is   the   logarithm   of   the   odds   for   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level1 contrast1"><span class="contrast level2 contrast2"> the   event   yi   1   ,   given   xi   ,   which   we   denote   by   LO(xi </span> <span class="subject level2 subject2"> ) </span>  .   It   is   often   useful   to   map   an   estimate   of   LO(x0   )   over   a   mesh   of   x0   R2   values </span>  <br> </br>
   .   <br> </br>
   <span class='indentation'>  </span>  <span class="subject level2 subject2"> This </span>  <br> </br>
   involves  <span class="contrast level1 contrast1"> the   bivariate   function   S(x0   )   ES(x0)y   is   an   ‘   optimal   ’   predictor   of </span>  S(x0   )   .   <br> </br>
   <br> </br>
   To   make   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level1 contrast1"><span class="contrast level2 contrast2"> (   2.2   )   practical   we   require   a   parsimonious   model   for   the   inter-point   covariances   covS(x   )   ,   S(x   )   ,   x   ,   x   R2 </span></span>  <br> </br>
  <span class="contrast level1 contrast1"> . </span>  <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level1 contrast1"><span class="contrast level2 contrast2"> We   propose   to   use   the   isotropic   model   covS(x   )   ,   S(x   )   C(x   x   )   ,   (   2.3   )   where   v   vTv   and   C   is   member   of   the   Matern   family   of   covariance   functions   (   see   Stein   ,   1999   ) </span></span>  <br> </br>
   .   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level2 contrast2"> We   will   work   in   the   subfamily   corresponding   to   a   single   value   of   the   Matern   smoothness   parameter   :   C(r   )   2x   (   1   +   r   ) </span>  <br> </br>
   er   .   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level1 contrast1"><span class="subject level2 subject2"> (   2.4   ) </span> <span class="contrast level2 contrast2"> The   function   given   in   ( </span></span>  <br> </br>
  <span class="contrast level1 contrast1"> 2.4 </span>  <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level1 contrast1"><span class="subject level2 subject2"> ) </span> <span class="contrast level2 contrast2"> is   the   simplest   member   of   the   Matern   family   that   yields   differentiable   surface   estimate </span></span>  <br> </br>
   .   <br> </br>
   <br> </br>
   Kammann   and   Wand  <span class="contrast level1 contrast1"> ( </span>  <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level1 contrast1"><span class="contrast level2 contrast2"> 2003   ) </span>  provide   further   discussion   of   the   choice   of   the   Matern   smoothness   parameter </span>  <br> </br>
   .   <br> </br>
   <span class='indentation'>  </span>  <span class="subject level2 subject2"> To </span> <span class="contrast level2 contrast2"> ensure   scale   invariance   ,   increase   numerical   stability   and   reduce   the   computational   burden   ,   we   choose   the   range   parameter   via   the   simple   rule   max   1i   , </span>  <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level2 contrast2"> jn   xi   x   j. </span> <span class="subject level2 subject2"> (   2.5 </span>  <br> </br>
   )   <br> </br>
   <span class='indentation'>  </span>  <span class="subject level2 subject2"> Fixing </span> <span class="contrast level2 contrast2"> a   priori   allows   the   use   of   the   generalized   linear   model   for   fitting </span>  <br> </br>
   .   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level2 contrast2"> In   our   experience   ,   the   smoothness   of   the   estimate   surface   depends   on   the   choice   of   , </span>  <br> </br>
   but   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level2 contrast2"> the   scale   of   the   final   map   is   rather   insensitive </span>  <br> </br>
   .   <br> </br>
   <span class='indentation'>  </span>  <span class="subject level2 subject2"> Generalized </span> <span class="contrast level2 contrast2"> additive   models   for   cancer   mapping   with   incomplete   covariates </span>  <br> </br>
   181   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level1 contrast1"><span class="contrast level2 contrast2"> [   C0(k   k   ) </span></span>  <br> </br>
  <span class="contrast level1 contrast1"> ] </span>  <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level1 contrast1"><span class="contrast level2 contrast2"> 1k   ,   kKx </span>  ,   where   C0(r </span>  <br> </br>
   )  <span class="contrast level1 contrast1"> (   1   +   r   ) </span>  er   .   <br> </br>
   <br> </br>
   Then   low-rank   kriging   corresponds   to   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level1 contrast1"><span class="contrast level2 contrast2"> fitting   the   logistic   mixed   model   Z(x0   )   [   C0(x0   k)]1kKx </span>  12 </span>  <br> </br>
   .   <br> </br>
   <span class='indentation'>  </span>  <span class="subject level2 subject2"> In </span> <span class="contrast level2 contrast2"> the   Upper   Cape   Cod   cancer   study   there   are   data   on   smoking   and   age   for   which   we   would   like   to   control </span>  <br> </br>
   .   <br> </br>
   <span class='indentation'>  </span>  <span class="subject level2 subject2"> Since </span> <span class="contrast level2 contrast2"> the   age   effect   is   possibly   non-linear   we   propose   to   model   it   as   an   arbitrary   smooth   function   ,   f </span>  <br> </br>
   .   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level2 contrast2"> Assuming   additivity   in   the   logit   scale   ,   we   arrive   at   logitP(yi   1b </span>  <br> </br>
   )  <span class="contrast level1 contrast1"> (   X   +   Zb)i   +   ssi   +   f   (   ai   )   ,   where </span>  ai   is   the   age   of   person   i   and   si   1   if   person   <br> </br>
   <br> </br>
   i   was   ever   a   smoker   and   zero   otherwise   .   a   Ka   be   a   set   of   knots   equally   spaced   with   respect   to   the   quantiles   of   the   ai   and   set   If   we   redefine   Z  <span class="contrast level1 contrast1"> [   Za12a   Z   ]   ,   (   2.8   ) </span>  then   <br> </br>
   the   model   has   the   representation   where   1n   is   the   1   n   vector   of   ones   .   <br> </br>
   <span class='indentation'>  </span>  <span class="subject level2 subject2"> A   common   convention   in   additive   modelling   is   to   centre   the   curve   estimates   about   their   means   .   The   components   of   the   additive   model   can </span> <span class="contrast level2 contrast2"> be   interpreted   as </span>  <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level2 contrast2"> effects </span> <span class="subject level2 subject2"> about   the   mean </span>  <br> </br>
   .   <br> </br>
   <span class='indentation'>  </span>  <span class="subject level2 subject2"> The   same   convention   could </span> <span class="contrast level2 contrast2"> be   applied   to   the   surface   estimate   in   the   kriging   component   of   the   geoadditive   model </span>  <br> </br>
   .   <br> </br>
   <span class='indentation'>  </span>  <span class="subject level2 subject2"> Operationally </span> <span class="contrast level2 contrast2"> we   set </span>  <br> </br>
   C   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level1 contrast1"><span class="contrast level2 contrast2"> [   XZ   ] </span></span> <span class="subject level2 subject2"> and   let </span> <span class="contrast level2 contrast2"> C   [   1Cr   ]   be   a   partition   of   C   into   the   intercept   column   and   the   remainder </span>  <br> </br>
   .   <br> </br>
   <span class='indentation'>  </span>  <span class="subject level2 subject2"> We </span> <span class="contrast level2 contrast2"> then   work   with </span>  <br> </br>
   C  <span class="contrast level1 contrast1"><span class="contrast level1 contrast1"> [ </span> <span class="contrast level1 contrast1"> 1(I </span> <span class="contrast level1 contrast1"> 1n </span> <span class="contrast level1 contrast1"> 11T)Cr </span> <span class="contrast level1 contrast1"> ] </span> <span class="contrast level1 contrast1"> ( </span> <span class="contrast level1 contrast1"> 2.11 </span> <span class="contrast level1 contrast1"> ) </span></span>  rather   than   C.   This   convention   is   adopted   in   our   analyses   in   Section   4   .   A   consequence   of   this   centering   is   that   a   map   of   expS(x0   )   over   <br> </br>
   a   mesh   of   x0   values   plots   the   ratio   of   the   odds   for   the   event   y   1   at   x0   relative   to   the   geometric   mean   odds   over   the   mapped   region   .   2.1   Fitting   as   a   generalized   <br> </br>
   linear   mixed   model   Maximum   likelihood   inference   for   generalized   linear   mixed   effects   models   is   based   on   maximizing  <span class="contrast level1 contrast1"> the </span> <span class="subject level1 subject1"> observed-data   likelihood </span> <span class="contrast level1 contrast1"> L   (   y   ) </span>  <br> </br>
   Generalized   additive   models   for   cancer   mapping   with   incomplete   covariates   183   In   most   cases   ,   including   the   logistic   mixed   model   used   in  <span class="contrast level1 contrast1"> (   2.9   )   and   (   2.10   ) </span>  <br> </br>
   ,   this   integral   is   intractable   .   <br> </br>
   <br> </br>
   Thus   ,   we   can   not   find   maximum   likelihood   estimates   using   the   exact   observed-data   likelihood   .   The   GLIMMIX   macro   in   SAS   overcomes   this   with   an   algorithm   <br> </br>
   commonly   referred   to   as  <span class="contrast level1 contrast1"> penalized </span> <span class="subject level1 subject1"> quasi-likelihood </span> <span class="contrast level1 contrast1"> (   PQL   )   that   essentially   replaces   (   2.15   ) </span>  by   a   Laplace   approximation   .   Another   approach   to   finding   <br> </br>
   maximum   likelihood   estimate   of   is   to   use   the  <span class="contrast level1 contrast1"> EM   algorithm   (   Dempster   et   al.   ,   1977   ) </span>  .   The   EM   algorithm   is   a   general   purpose   algorithm   for   finding   the   mode   of   a   <br> </br>
   likelihood   or   posterior   density   function   .   Viewing   the   random   effects   as   latent   variables   ,   the   EM   algorithm   iterates   between   calculating   the   <br> </br>
   conditional   expectation   of   the   complete-data   log   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level2 contrast2"><span class="subject level1 subject1"> likelihood   , </span></span> <span class="contrast level1 contrast1"><span class="subject level2 subject2"> (   y </span> <span class="contrast level2 contrast2"> ,   b   )   log   p(y   , </span></span>  <br> </br>
  <span class="contrast level1 contrast1"> b </span>  <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level1 contrast1"><span class="subject level2 subject2"> ) </span></span> <span class="contrast level2 contrast2"> ,   given   the   observed   data   and   maximizing   this   expected   value   as   a   function   of </span>  <br> </br>
   .   <br> </br>
   <br> </br>
  <span class="contrast level1 contrast1"> Dempster   et   al.   (   1977   ) </span>  have   shown   that   the   EM   algorithm   will   lead   to   the   maximum   likelihood   estimates   based   on   the   observeddata   likelihood   given   in   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level1 contrast1"><span class="contrast level2 contrast2"> equation   (   2.14   ) </span></span> <span class="subject level2 subject2"> .   In   fact   ,   since   the   observed-data   likelihood   is   log-concave   ,   the   EM   algorithm   will   work   quite   well   because </span> <span class="contrast level2 contrast2"> it   will   not   get   stuck   in   local </span>  <br> </br>
   modes   <br> </br>
   <span class='indentation'>  </span>  <span class="subject level2 subject2"> .   In   the   context   of   the   generalized   linear   mixed   effects   model </span>  <br> </br>
   ,   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level2 contrast2"><span class="subject level1 subject1"> the </span> <span class="contrast level1 contrast1"> ( </span> <span class="subject level2 subject2"> m   +   1)th   iteration   of   the   EM   algorithm   is   E-step   :   Calculate   Q((m   )   )   E   (   y   ,   b)y </span> <span class="contrast level2 contrast2"> ,   (   m   ) </span></span>  <br> </br>
   ,   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level2 contrast2"> where   the   expectation   is   taken   with   respect   to </span>  <br> </br>
   p(by  <span class="contrast level1 contrast1"> (   m   )   ) </span>  .   <br> </br>
   <br> </br>
   M-Step   :   Set  <span class="contrast level1 contrast1"> (   m+1   )   argmax   Q((m   )   ) </span>  .   The   algorithm   alternates   between   these   two   steps   until   there   is   a   sufficiently   small   change   in   the   parameter   values   <br> </br>
   between   iterations   .   When   working   with   generalized   linear   mixed   effects   models   ,   the   expectation   step   involves   evaluating  <span class="contrast level1 contrast1"> the   quantity </span> <span class="subject level1 subject1"> Q </span> <span class="contrast level1 contrast1"> (   )   (   y   ,   b   )   p(by   ) </span>  <br> </br>
   db   The   Monte   Carlo   EM   methodology   is   quite   computationally   intensive   and   more   suited   to   smaller   numbers   of   random   effects   and   sample   sizes   .   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level2 contrast2"> Neither   is   the   case   for   the   geoadditive   model   for   the </span> <span class="subject level2 subject2"> Upper   Cape   Cod   data   where </span> <span class="contrast level2 contrast2"> b   may   have   dimension   of   100   and   n   3191 </span>  <br> </br>
   .   <br> </br>
   <span class='indentation'>  </span>  <span class="subject level2 subject2"> The </span> <span class="contrast level2 contrast2"> MCEM   approach   is   simply   not   practical   and   an   asymptotic   approximation   seems   necessary </span>  <br> </br>
   .   Steele  <span class="contrast level1 contrast1"> (   1996   ) </span>  describes   an   EM   algorithm   that   alternates   between   calculating   D   Q   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level1 contrast1"><span class="contrast level2 contrast2"> (   )   ,   a   second-order   Laplace   approximation </span>  to   D   Q   (   )   ,   and   solving   D   Q   (   )   0 </span>  <br> </br>
   .   <br> </br>
   <span class='indentation'>  </span>  <span class="subject level2 subject2"> Assuming </span> <span class="contrast level2 contrast2"> that   the   order   of   differentiation   and   integration   can   be   interchanged   ,   a   standard   assumption   of   the   EM   algorithm   , </span> <span class="subject level2 subject2"> D   Q   (   )   Regularity   conditions </span>  <br> </br>
   <span class='indentation'>  </span>  <span class="subject level2 subject2"> allow </span> <span class="contrast level2 contrast2"> the   fully   exponential   Laplace </span>  <br> </br>
   approximation  <span class="contrast level1 contrast1"> (   Tierney   et   al.   ,   1989   ) </span>  to   the   expected   complete-data   score   vector  <span class="contrast level1 contrast1"> (   2.17   ) </span>  ,   but   not   the   expected   complete-data   log-likelihood  <span class="contrast level1 contrast1"> (   Steele   , </span>  <br> </br>
  <span class="contrast level1 contrast1"> where   b   (   )   argmaxb   p(y   ,   b   ) </span>  .   <br> </br>
   <br> </br>
   The   term   C   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level1 contrast1"><span class="subject level2 subject2"> (   y   ,   b   ) </span></span> <span class="contrast level2 contrast2"> C(k   y   , </span>  <br> </br>
   b)1kp+S   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level2 contrast2"> is   an   adjustment </span> <span class="subject level2 subject2"> that   allows </span>  <br> </br>
   D   Q  <span class="contrast level1 contrast1"> (   ) </span>  to   differ   from   D   Q   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level1 contrast1"><span class="subject level2 subject2"> ( </span> <span class="contrast level2 contrast2"> )   by   a   O(n2   ) </span>  term </span>  <br> </br>
   .   <br> </br>
   <span class='indentation'>  </span>  <span class="subject level2 subject2"> The </span> <span class="contrast level2 contrast2"> individual   correction   terms   are   given   by   A1 </span>  <br> </br>
   k   A   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level1 contrast1"><span class="contrast level2 contrast2"> ZTU </span> <span class="subject level1 subject1"> diag </span> <span class="contrast level1 contrast1"> (   k   (   y   ,   b   )   ]   T   )   Z   the   last   term   in   (   2.18   ) </span></span>  <br> </br>
   .   <br> </br>
   <span class='indentation'>  </span>  <span class="subject level2 subject2"> Using   this   simplified   approximation   ,   the   estimating   equations   for   in   the </span> <span class="contrast level2 contrast2"> Laplace   EM </span>  <br> </br>
   algorithm   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level1 contrast1"><span class="contrast level2 contrast2"> (   Steele   , </span></span>  <br> </br>
  <span class="contrast level1 contrast1"> 1996 </span>  <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level1 contrast1"><span class="contrast level2 contrast2"> )   and   the   PQL   algorithm   (   Breslow   and   Clayton   ,   1993   ) </span>  are   identical </span>  <br> </br>
   .   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level1 contrast1"><span class="contrast level2 contrast2"> That   is   ,   both   algorithms   solve   XT(y   ) </span>  0   , </span> <span class="subject level2 subject2"> where   B(X   +   Zb   ) </span>  <br> </br>
   .   The   two   algorithms   differ   in   the   manner   in   which   is   estimated   .   However   ,   when   the   estimates   of   are   similar   ,   the   Laplace   EM   algorithm   should   yield   more   <br> </br>
   accurate   estimates   of   the   fixed   effects   since   they   are   based   on   a   second-order   approximation   rather   than   a   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level2 contrast2"><span class="subject level1 subject1"> first-order   approximation </span></span> <span class="contrast level1 contrast1"><span class="subject level2 subject2"> (   Steele   ,   1996   ) </span>  . </span>  <br> </br>
   <span class='indentation'>  </span>   <br> </br>
   <span class='indentation'>  </span>  <span class="subject level2 subject2"> Missing   covariate   values   are   common   in   environmental   and   public   health   data   . </span> <span class="contrast level2 contrast2"> These   values </span>  <br> </br>
   may   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level2 contrast2"> be   missing   by   design </span>  <br> </br>
   (   <br> </br>
   <span class='indentation'>  </span>  <span class="subject level2 subject2"> e.g.   when   some </span> <span class="contrast level2 contrast2"> data   are   collected   only   on   a   subset   of </span> <span class="subject level2 subject2"> subjects   ) </span>  <br> </br>
   or   <br> </br>
   <span class='indentation'>  </span>  <span class="subject level2 subject2"> , </span> <span class="contrast level2 contrast2"> as   is   more   commonly   the   case   ,   missing   unintentionally </span>  <br> </br>
   .   The   standard   approach   is   to   perform   a   complete-case   analysis   ,   in   which   cases   with   missing   values   are   excluded   from   the   analysis   .   This   approach   can   lead   <br> </br>
   to   a   substantial   loss   of   information   if   many   variables   exhibit   missingness   .   Worse   still   ,   it   can   yield   biased   parameter   estimates   if   the   missingness   <br> </br>
   depends   on  <span class="contrast level1 contrast1"> the </span> <span class="subject level1 subject1"> response   variable </span> <span class="contrast level1 contrast1"> (   Jones   ,   1996   ) </span>  .   <br> </br>
   <br> </br>
   Likelihood-based   methods   ,   such   as   the   EM   algorithm   ,   use   all   of   the   available   data   ,   including   those   observations   with   missing   covariate   values   .   They   are   <br> </br>
   particularly   attractive   because   they   provide   valid   inference   when   the   missing   values   are   missingat-random   in   the   sense   of   Little   and   Rubin  <span class="contrast level1 contrast1"> (   1987   ) </span>  and   <br> </br>
   can   be   extended   to   include   situations   when   the   data   are   not   missing-at-random   .   <br> </br>
   <br> </br>
   One   interesting   feature   of   the   complete-case   analysis   is   that   estimates   are   not   biased   when   the   missingness   depends   on   the   missing   covariate   values   ,   a   <br> </br>
   property   that   is   not   shared   by   likelihood-based   methods   .   In   the   Upper   Cape   Cod   cancer   study   ,   the   geographic   location   and   age   variables   are   completely   <br> </br>
   observed   for   all   subjects   ,   but   smoking   status   is   missing   for   29   %   of   the   subjects   .   Table   1   shows   that   the   missingness   in   smoking   status   depends   on   the   cancer   <br> </br>
   type   ,   with   smoking   status   missing   for   41.0   %   of   prostate   cancer   patients   and   24.2   %   of   patients   with   other   types   of   cancer   .   <br> </br>
   <br> </br>
   This   is   precisely   the   situation   in   which   complete   case   methods   will   lead   to   biased   inference   .   So   ,   an   alternative   method   is   needed   .   We   begin   by   considering   <br> </br>
   a   model   with   D   discrete   and   S   continuous   covariates   ,   whose   values   for   subject   i   will   be   denoted   by   di   and   ci   ,   respectively   .   To   simplify   the   notation   ,   we   <br> </br>
   assume   that   we   are   smoothing   each   of   the   S   continuous   covariates   .   Suppose   that   the   response   y   and   all   continuous   covariates   are   completely   observed   ,   but   <br> </br>
   that   some   of   the   values   for   di   may   be   missing-at-random   for   each   subject   .   For   the   i   th   subject   ,   let   dobsi   and   d   miss   i   denote   the   vectors   of   observed   and   <br> </br>
   missing   values   and   ni   denote   the   number   of   possible   combinations   of   values   for   dmissi   .   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level2 contrast2"> For   the   appropriate   X   ,   Z   ,   and </span>  <br> </br>
   b   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level2 contrast2"> ,   we   can   express   the   complete-data   density </span> <span class="subject level2 subject2"> as   Generalized   additive   models   for   cancer   mapping </span>  <br> </br>
   with   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level1 contrast1"><span class="contrast level2 contrast2"> incomplete   covariates   185   where </span></span>  <br> </br>
  <span class="contrast level1 contrast1"> ( </span>  <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level1 contrast1"><span class="subject level2 subject2"> T   ,   T </span></span>  <br> </br>
  <span class="contrast level1 contrast1"> , </span>  T)T   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level1 contrast1"><span class="contrast level2 contrast2"> is   a   (   p   +   q   +   S   ) </span>  1   vector   of   parameters </span>  <br> </br>
   .   <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level2 contrast2"> This   likelihood   differs   from   the   one   in   Section   2   because   we   need   to   model   p(dc   )   ,   the   conditional   density   of   the   missing   covariates   given   the   observed </span>  <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level2 contrast2"> covariates </span>  <br> </br>
   .   <br> </br>
   <span class='indentation'>  </span>  <span class="subject level2 subject2"> Since </span> <span class="contrast level2 contrast2"> a   joint   model   for   p(dc   )   can   be   difficult   to   specify   in   general   ,   we   typically   model   p(dc   )   as   the   product   of   conditional   densities   in   the   same   manner   as </span>  <br> </br>
   <span class='indentation'>  </span>  <span class="contrast level2 contrast2"> Lipsitz </span>  <br> </br>
   and  <span class="subject level1 subject1"> Ibrahim </span> <span class="contrast level1 contrast1"> (   1996   ) </span>  .   <br> </br>
   <br> </br>
   That   is   ,   we   express   Since   dmiss   and   b   are   not   observed   ,   we   base   our   inference   on   the   observed-data   likelihood   L  <span class="contrast level1 contrast1"> (   y   ,   c   ,   dobs   )   dmiss   p(y   ,   d   ,   bc   ) </span>  db   ,   where   the   <br> </br>
   summation   is   over   all   possible   combinations   of   the   missing   discrete   variables   .   <br> </br>
   <br> </br>
   The   observeddata   likelihood   in   the   missing   covariate   case   is   even   more   difficult   to   work   with   than   that   in   the   complete-covariate   case   ,   but   the   <br> </br>
   complete-data   likelihood   remains   relatively   easy   to   manipulate   . 
</body>
</html>
